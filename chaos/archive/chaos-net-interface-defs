;chaos NET INTERFACE DEFS			- 6/15/76    DAM
;DRAWINGS chaos;11CON,CPINS,DATAPA,DETECT,ICON,MODULA,MY#,MYTURN,PROGCK,RBUF,RCTL,
;	TBUF,TBUFIN,TCLK,WRDBTS

;11CON FOR ADDRESS JUMPERS, ICON FOR VECTOR JUMPERS
;USUAL ADDRESS IS 776660.  USUAL INTERRUPT VECTOR IS 270.

CAICSR=176660		;COMMAND STATUS REG
 %CABSY==1		;1.1 XMT BUSY (RO)
 %CACW==2		;1.2 CABLE WAIT (FOR CABLE FREE & MY-TURN) (RO)
 %CASPY==4		;1.3 RECIEVE MSGS FOR ANY DESTINATION (R/W)
 %CACEN==10		;1.4 CLK INT ENB (R/W)
 %CAREN==20		;1.5 RCV INT ENB (R/W)
 %CATEN==40		;1.6 XMT INT ENB (R/W)
 %CATAB==100		;1.7 TRANSMIT ABORTED BY ETHER CONFLICT (RO)
 %CATDN==200		;1.8 TRANSMIT DONE. SET BY WRITING 1, CLEARED WHEN XMT STARTS.
 %CACLK==400		;1.9 CLOCK FLAG (RO)
			;2.1-2.4 LOST COUNT (RO) [# MSGS RCVED WITH RCV BFR FULL]
			;        WHEN MSG IS WAITING IN BUFFER, THIS COUNTS
			;        THE MESSAGES THAT MATCHED OUR DESTINATION OR
			;        WERE BROADCAST, BUT COULDN'T BE RECIEVED.
			;	 WHEN RECEIVER IS RE-ENABLED (WRITE 1 INTO %CARDN)
			;	 THE COUNT IS COPIED INTO THESE CSR BITS, THEN CLEARED.
			;	 WHEN A MESSAGE IS LOST, RECEIVER ZAPS ETHER
			;	 SO TRANSMITTER WILL ABORT (IF MESSAGE WAS DESTINED
			;        TO US.)
 %CARST==20000		;2.5 I/O RESET (WO)
 %CAERR==40000		;2.6 CRC ERROR (RO)
 %CARDN==100000		;2.7 RCV DONE.  WRITING 1 CLEARS RCV DONE AND ENABLES
			;    RECEIVER TO GOBBLE ANOTHER MESSAGE.
   ;DON'T USE BIC AND BIS INSTRUCTIONS ON THIS REGISTER, UNLESS YOU'RE SURE
   ;YOU AREN'T LOSING WITH WRITING 1S INTO BITS THAT DO WIERD THINGS WHEN
   ;1S ARE WRITTEN INTO THEM.

CAIXMT=176662		;READING THIS INITIATES TRANSMISSION (!!)
			;THE VALUE READ IS ONE'S OWN HOST#.

CAIRBF=176664		;READ BUFFER (READ ONLY)
			;THE FIRST WORD READ WILL BE FILLED TO THE LEFT
			;TO MAKE THE MESSAGE RECIEVED A MULTIPLE OF 16 BITS.
			;IF THE NUMBER OF DATA BITS IN THE MESSAGE WAS A
			;MULTIPLE OF 16, THIS WORD WILL BE THE FIRST WORD PUT
			;INTO THE BUFFER BY THE TRANSMITTING HOST.
			;THE LAST 3 WORDS READ ARE DESTINATION, SOURCE, CHECK.

CAIRBC=176666		;RECEIVE BIT COUNTER  (READ ONLY)
			;WHEN A MESSAGE HAS BEEN RECEIVED THIS IS ONE LESS THAN
			;THE NUMBER OF BITS IN THE MESSAGE (16 X THE
			;NUMBER OF WORDS INCLUDING THE THREE OVERHEAD WORDS.)
			;AFTER THE LAST WORD (THE CRC WORD) HAS BEEN READ, IT IS -1.
			;BIT 2.2=BUFFER OVERFLOW, 2.3-2.7 ARE ALL SAME

CAICLK=176666		;REAL-TIME CLOCK INTERVAL (WRITE ONLY)
			;WRITING THIS CLEARS CLOCK FLAG AND STARTS THE CLOCK.
			;COUNTER COUNTS DOWN EVERY 1 MICRO-SECOND; WHEN
			;IT REACHES ZERO IT STOPS AND RAISES THE CLOCK FLAG.

CAIMYN=176672		;MY # (READ ONLY)
			;RETURNS THE [SOURCE] HOST# OF THIS INTERFACE.		

CAIWBF=176672		;WRITE BUFFER (WRITE ONLY)
			;FIRST WAIT FOR TDONE. (OR SET IT VIA CSR)
			;FIRST WORD IN RESETS TRANSMITTER AND CLEARS TDONE.
			;STORE INTO THIS REGISTER TO WRITE WORDS OF MESSAGE,
			;LAST WORD IN IS DESTINATION ADDRESS, THEN READ CAIXMT.
			;SOURCE ADDRESS AND CHECK WORD PUT IN BY HARDWARE.

;REFERENCING ADDRESSES IN THE GROUP OF 8 WORDS NOT LISTED HERE, OR
;USING COMBINATIONS OF READ/WRITE NOT LISTED HERE, WILL TYPICALLY CAUSE
;STRANGE AND BIZARRE EFFECTS.